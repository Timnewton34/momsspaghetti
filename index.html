<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Meal Planner</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* All CSS goes here */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding-bottom: 70px;
        }

        #this-weeks-meals, #all-meal-ideas, #grocery-list {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        header {
            background-color: #333;
            color: white;
            padding: 10px 20px;
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
        }

        nav {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        nav a:hover {
            background-color: #555;
        }

        .meal-row {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .meal-row img {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 5px;
        }

        .meal-row .day-of-week {
            font-weight: bold;
            min-width: 90px;
        }

        .meal-row .meal-name {
            flex-grow: 1;
        }

        #create-grocery-list {
            display: block;
            width: 100%;
            padding: 15px;
            margin-top: 20px;
            background-color: #007bff;
            color: white;
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #create-grocery-list:hover {
            background-color: #0056b3;
        }

        .buttons-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .favorite-btn {
            font-size: 2em;
            cursor: pointer;
            color: #ccc;
            transition: color 0.2s ease-in-out;
        }

        .favorite-btn.is-favorited {
            color: #ff6347;
        }

        /* Modal (popup) styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            padding-top: 60px;
        }

        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            border-radius: 8px;
            box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
        }

        .close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: black;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <a href="#this-weeks-meals" id="nav-this-week">This Week's Meals</a>
            <a href="#grocery-list" id="nav-grocery-list">Grocery List</a>
            <a href="#all-meal-ideas" id="nav-all-ideas">All Meal Ideas</a>
        </nav>
    </header>

    <main>
        <section id="this-weeks-meals">
            <h1>This Week's Meals</h1>
            <button id="create-grocery-list">Create Grocery List</button>
        </section>

        <section id="all-meal-ideas" style="display: none;">
            <h1>All Meal Ideas</h1>
        </section>
            
        <section id="grocery-list" style="display: none;">
            <h1>Grocery List</h1>
            <div id="grocery-list-container">
            </div>
        </section>
    </main>

    <footer>
        </footer>

    <div id="recipe-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2 id="recipe-title"></h2>
            <p id="recipe-text"></p>
        </div>
    </div>

    <script>
        // All JavaScript goes here
        // A mapping of ingredients to their grocery store sections
        const grocerySections = {
            "Produce": ["Onion", "Broccoli", "Asparagus", "Basil", "Lemon"],
            "Meats": ["Ground Beef", "Chicken Breast", "Salmon Fillet", "Pepperoni"],
            "Dairy": ["Mozzarella Cheese", "Cheese Sauce"],
            "Pantry": ["Spaghetti", "Tomato Sauce", "Pizza Dough", "Macaroni", "Buns"]
        };

        // Master list of all available meals (hard-coded again)
        const meals = [
            {
                name: "Spaghetti and Meatballs",
                image: "https://via.placeholder.com/150/ff7f7f",
                ingredients: ["Spaghetti", "Ground Beef", "Tomato Sauce", "Onion"],
                recipe: "Boil spaghetti. Cook meatballs in sauce. Combine and serve."
            },
            {
                name: "Basil Grilled Chicken with Broccoli",
                image: "https://via.placeholder.com/150/7fffd4",
                ingredients: ["Chicken Breast", "Basil", "Broccoli"],
                recipe: "Season chicken with basil. Grill until cooked through. Steam broccoli and serve."
            },
            {
                name: "Grilled Salmon with Asparagus",
                image: "https://via.placeholder.com/150/add8e6",
                ingredients: ["Salmon Fillet", "Asparagus", "Lemon"],
                recipe: "Preheat grill. Season salmon and asparagus with salt, pepper, and lemon. Grill until cooked."
            },
            {
                name: "Leftovers",
                image: "https://via.placeholder.com/150/c2c2c2",
                ingredients: [],
                recipe: "Heat up your favorite leftovers and enjoy."
            },
            {
                name: "Pepperoni Pizza",
                image: "https://via.placeholder.com/150/ffb6c1",
                ingredients: ["Pizza Dough", "Pepperoni", "Mozzarella Cheese", "Tomato Sauce"],
                recipe: "Top pizza dough with sauce, cheese, and pepperoni. Bake until crust is golden."
            },
            {
                name: "Hamburgers with Mac & Cheese",
                image: "https://via.placeholder.com/150/ffd700",
                ingredients: ["Ground Beef", "Buns", "Macaroni", "Cheese Sauce"],
                recipe: "Form patties and cook hamburgers. Prepare mac & cheese according to package directions. Serve together."
            }
        ];

        // User's weekly meal plan
        const weeklyPlan = {
            "monday": 0,
            "tuesday": 1,
            "wednesday": 2,
            "thursday": 3,
            "friday": 4,
            "saturday": 5,
            "sunday": 3
        };

        // Global variable for which day is being edited
        let editingDay = null;
        let favoriteMeals = [];

        // --- Script to generate and manage content ---

        // Function to generate the HTML for a single meal row
        function createMealRowHTML(day, meal) {
            const dayName = day.charAt(0).toUpperCase() + day.slice(1);
            const mealIndex = meals.findIndex(m => m.name === meal.name);
            const isFavorited = favoriteMeals.includes(mealIndex) ? " is-favorited" : "";

            return `
                <div class="meal-row">
                    <p class="day-of-week">${dayName}</p>
                    <div class="meal-content" data-meal-index="${mealIndex}">
                        <img src="${meal.image}" alt="${meal.name}">
                        <p class="meal-name">${meal.name}</p>
                    </div>
                    <div class="buttons-container">
                        <span class="favorite-btn${isFavorited}" data-meal-index="${mealIndex}">&hearts;</span>
                        <button class="edit-btn" data-day="${day}">Edit</button>
                    </div>
                </div>
            `;
        }

        // Function to generate and display the weekly meal plan
        function displayWeeklyPlan() {
            const container = document.getElementById('this-weeks-meals');
            const button = document.getElementById('create-grocery-list');
            
            container.innerHTML = '<h1>This Week\'s Meals</h1>';
            
            for (const day in weeklyPlan) {
                const mealIndex = weeklyPlan[day];
                const meal = meals[mealIndex];
                if (meal) {
                    const mealRowHTML = createMealRowHTML(day, meal);
                    container.insertAdjacentHTML('beforeend', mealRowHTML);
                }
            }
            
            container.appendChild(button);
            enableEditButtons();
            addRecipeClickListeners();
            addFavoriteClickListeners();
        }

        // Function to generate and display all meal ideas
        function displayAllMealIdeas() {
            const container = document.getElementById('all-meal-ideas');
            container.innerHTML = '<h1>All Meal Ideas</h1>';

            meals.forEach((meal, index) => {
                if (meal.name !== "Leftovers") {
                    const isFavorited = favoriteMeals.includes(index) ? " is-favorited" : "";
                    const mealIdeaHTML = `
                        <div class="meal-row">
                            <div class="meal-content" data-meal-index="${index}">
                                <img src="${meal.image}" alt="${meal.name}">
                                <p class="meal-name">${meal.name}</p>
                            </div>
                            <div class="buttons-container">
                                <span class="favorite-btn${isFavorited}" data-meal-index="${index}">&hearts;</span>
                                <button class="select-btn" data-meal-index="${index}">Select</button>
                            </div>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', mealIdeaHTML);
                }
            });
            enableSelectButtons();
            addRecipeClickListeners();
            addFavoriteClickListeners();
        }

        // Function to generate and display the grocery list
        function generateGroceryList() {
            const weeklyIngredients = new Set();
            for (const day in weeklyPlan) {
                const mealIndex = weeklyPlan[day];
                const meal = meals[mealIndex];
                if (meal && meal.ingredients.length > 0) {
                    meal.ingredients.forEach(ingredient => {
                        weeklyIngredients.add(ingredient);
                    });
                }
            }

            const container = document.getElementById('grocery-list-container');
            container.innerHTML = '';

            for (const section in grocerySections) {
                const sectionItems = [];
                weeklyIngredients.forEach(ingredient => {
                    if (grocerySections[section].includes(ingredient)) {
                        sectionItems.push(ingredient);
                    }
                });

                if (sectionItems.length > 0) {
                    let sectionHTML = `<h3>${section}</h3><ul>`;
                    sectionItems.forEach(item => {
                        sectionHTML += `<li>${item}</li>`;
                    });
                    sectionHTML += `</ul>`;
                    container.insertAdjacentHTML('beforeend', sectionHTML);
                }
            }
        }

        // Function to show a single content section and hide others
        function showSection(sectionId) {
            const sections = document.querySelectorAll('main section');
            sections.forEach(section => {
                section.style.display = 'none';
            });

            const activeSection = document.getElementById(sectionId);
            if (activeSection) {
                activeSection.style.display = 'block';
            }
        }

        // Function to enable the edit buttons on the weekly plan page
        function enableEditButtons() {
            const editButtons = document.querySelectorAll('.edit-btn');
            editButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const dayToEdit = event.target.dataset.day;
                    editingDay = dayToEdit;
                    showSection('all-meal-ideas');
                });
            });
        }

        // Function to enable the select buttons on the meal ideas page
        function enableSelectButtons() {
            const selectButtons = document.querySelectorAll('.select-btn');
            selectButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const mealIndex = event.target.dataset.mealIndex;
                    weeklyPlan[editingDay] = parseInt(mealIndex);
                    displayWeeklyPlan();
                    showSection('this-weeks-meals');
                });
            });
        }

        // Function to add click listeners to all meal images and names
        function addRecipeClickListeners() {
            const mealContent = document.querySelectorAll('.meal-content');
            const modal = document.getElementById('recipe-modal');
            const closeBtn = document.querySelector('.close-btn');

            mealContent.forEach(content => {
                content.addEventListener('click', (event) => {
                    let targetDiv = event.target.closest('.meal-content');
                    if (targetDiv) {
                        const mealIndex = targetDiv.dataset.mealIndex;
                        showRecipe(mealIndex);
                    }
                });
            });

            closeBtn.addEventListener('click', () => {
                modal.style.display = 'none';
            });

            window.addEventListener('click', (event) => {
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // Function to handle adding/removing favorites
        function addFavoriteClickListeners() {
            const favoriteButtons = document.querySelectorAll('.favorite-btn');
            favoriteButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    const mealIndex = parseInt(event.target.dataset.mealIndex);

                    const indexInFavorites = favoriteMeals.indexOf(mealIndex);

                    if (indexInFavorites === -1) {
                        favoriteMeals.push(mealIndex);
                        event.target.classList.add('is-favorited');
                    } else {
                        favoriteMeals.splice(indexInFavorites, 1);
                        event.target.classList.remove('is-favorited');
                    }
                });
            });
        }

        // Function to show the recipe modal
        function showRecipe(mealIndex) {
            const modal = document.getElementById('recipe-modal');
            const title = document.getElementById('recipe-title');
            const text = document.getElementById('recipe-text');

            const meal = meals[mealIndex];
            if (meal) {
                title.textContent = meal.name;
                text.textContent = meal.recipe;
                modal.style.display = "block";
            }
        }

        // Add click event listeners to the navigation links
        document.getElementById('nav-this-week').addEventListener('click', (e) => {
            e.preventDefault();
            displayWeeklyPlan();
            showSection('this-weeks-meals');
        });

        document.getElementById('nav-all-ideas').addEventListener('click', (e) => {
            e.preventDefault();
            displayAllMealIdeas();
            showSection('all-meal-ideas');
        });

        document.getElementById('nav-grocery-list').addEventListener('click', (e) => {
            e.preventDefault();
            generateGroceryList();
            showSection('grocery-list');
        });

        // Add a click listener to the "Create Grocery List" button
        document.getElementById('create-grocery-list').addEventListener('click', () => {
            generateGroceryList();
            showSection('grocery-list');
        });

        // Initial page setup on load
        displayWeeklyPlan();
        displayAllMealIdeas();
        showSection('this-weeks-meals');
    </script>
</body>
</html>